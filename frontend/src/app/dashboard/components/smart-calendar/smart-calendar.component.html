<div class="smart-calendar-container" #smartCalendarContainer>
  <div class="smart-calendar-header">
    <div class="header-info">
      <h2>Smart Calendar Insights</h2>
      <div class="calendar-info" *ngIf="currentMonth">
        <span class="month-info">{{ currentMonth }}</span>
        <span class="date-range">{{ currentDateRange }}</span>
      </div>
    </div>
    <div class="smart-calendar-controls">
      <button (click)="analyzeContent()" class="analyze-btn" matTooltip="Analyze Calendar Content">
        <mat-icon>analytics</mat-icon>
        Analyze
      </button>
      <button (click)="updateViewSettings()" class="optimize-btn" matTooltip="Optimize View Settings">
        <mat-icon>settings</mat-icon>
        Optimize
      </button>
      <button (click)="generateRecommendations()" class="recommend-btn" matTooltip="Get Recommendations">
        <mat-icon>lightbulb</mat-icon>
        Recommend
      </button>
    </div>
  </div>
  
  <div class="smart-calendar-content">
    <div class="calendar-metrics" *ngIf="metrics">
      <div class="metric-card">
        <mat-icon class="metric-icon">event</mat-icon>
        <h3>Total Slots</h3>
        <p>{{ metrics.totalSlots }}</p>
      </div>
      <div class="metric-card">
        <mat-icon class="metric-icon">book</mat-icon>
        <h3>Booked Slots</h3>
        <p>{{ metrics.bookedSlots }}</p>
      </div>
      <div class="metric-card">
        <mat-icon class="metric-icon">warning</mat-icon>
        <h3>Conflicts</h3>
        <p>{{ metrics.conflictingSlots }}</p>
      </div>
      <div class="metric-card">
        <mat-icon class="metric-icon">percent</mat-icon>
        <h3>Occupancy Rate</h3>
        <p>{{ metrics.occupancyRate }}%</p>
      </div>
    </div>
    
    <div class="smart-insights">
      <div class="insight-card" *ngIf="viewRecommendation">
        <h3>View Recommendation</h3>
        <p>Based on your content, we recommend using the <strong>{{ viewRecommendation }}</strong> view.</p>
        <button (click)="switchToRecommendedView()" class="switch-view-btn">
          Switch to {{ viewRecommendation }}
        </button>
      </div>
      
      <div class="insight-card" *ngIf="occupancyRate < 30">
        <h3>Low Occupancy Alert</h3>
        <p>Your calendar occupancy is {{ occupancyRate }}%. Consider adding more availability slots.</p>
      </div>
      
      <div class="insight-card" *ngIf="occupancyRate > 80">
        <h3>High Occupancy Notice</h3>
        <p>Your calendar occupancy is {{ occupancyRate }}%. You might want to add more capacity.</p>
      </div>
      
      <div class="insight-card" *ngIf="optimalBookingWindows && optimalBookingWindows.length > 0">
        <h3>Optimal Booking Windows</h3>
        <p>Based on your data, the best times for bookings are:</p>
        <ul>
          <li *ngFor="let window of optimalBookingWindows">{{ window.label }}</li>
        </ul>
      </div>
    </div>
  </div>
</div>