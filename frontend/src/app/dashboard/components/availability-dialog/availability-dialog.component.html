<h2 mat-dialog-title>{{ isNew ? (data.allDay ? 'Create All-Day Availability' : 'Create Availability Slot') : 'Edit Availability Slot' }}</h2>
<mat-dialog-content>
  <form class="availability-form">
    <!-- Date picker for one-off appointments -->
    <mat-form-field appearance="outline" *ngIf="!isRecurring">
      <mat-label>Date</mat-label>
      <input matInput [matDatepicker]="datepicker" [(ngModel)]="availability.date" (ngModelChange)="onDateChange($event)" name="date">
      <mat-datepicker-toggle matSuffix [for]="datepicker"></mat-datepicker-toggle>
      <mat-datepicker #datepicker></mat-datepicker>
    </mat-form-field>
    
    <!-- Enhanced All-Day Slot Configuration -->
    <div class="all-day-config" *ngIf="data.allDay">
      <mat-form-field appearance="outline">
        <mat-label>Number of Slots</mat-label>
        <input matInput type="number" [(ngModel)]="numberOfSlots" (ngModelChange)="onNumberOfSlotsChange($event)" name="numberOfSlots" min="1" max="24">
        <mat-icon matSuffix>view_module</mat-icon>
      </mat-form-field>
      
      <mat-checkbox [(ngModel)]="autoDistribute" (ngModelChange)="onAutoDistributeChange($event)" name="autoDistribute">
        Auto-Distribute Time Evenly
      </mat-checkbox>
      
      <div class="slot-preview" *ngIf="slotPreview.length > 0">
        <h3>Slot Preview</h3>
        <div class="preview-list">
          <div class="preview-item" *ngFor="let slot of slotPreview; let i = index">
            <span class="slot-number">{{ i + 1 }}.</span>
            <span class="slot-time">{{ formatTime(slot.startTime) }} - {{ formatTime(slot.endTime) }}</span>
            <span class="slot-duration">({{ slot.duration }} min)</span>
          </div>
        </div>
      </div>
      
      <mat-hint *ngIf="numberOfSlots > 8" class="warning-hint">
        Warning: Having more than 8 slots in a day may be difficult to manage.
      </mat-hint>
    </div>
    
    <div class="time-fields" *ngIf="!data.allDay">
      <mat-form-field appearance="outline">
        <mat-label>Start Time</mat-label>
        <input matInput type="time" [value]="formatTime(availability.startTime)" (change)="onStartTimeChange($event)" name="startTime">
        <mat-icon matSuffix>schedule</mat-icon>
      </mat-form-field>
    </div>
    
    <mat-form-field appearance="outline" *ngIf="!data.allDay">
      <mat-label>Duration</mat-label>
      <mat-select [value]="availability.duration" (selectionChange)="onDurationChange($event)" name="duration">
        <mat-option [value]="15">15 minutes</mat-option>
        <mat-option [value]="30">30 minutes</mat-option>
        <mat-option [value]="45">45 minutes</mat-option>
        <mat-option [value]="60">60 minutes</mat-option>
        <mat-option [value]="90">90 minutes</mat-option>
        <mat-option [value]="120">120 minutes</mat-option>
      </mat-select>
      <mat-icon matSuffix>timelapse</mat-icon>
    </mat-form-field>
    
    <mat-checkbox [(ngModel)]="isRecurring" (ngModelChange)="onRecurringChange($event)" name="isRecurring">
      Recurring Availability
    </mat-checkbox>
    
    <mat-form-field appearance="outline" *ngIf="isRecurring">
      <mat-label>Day of Week</mat-label>
      <mat-select [(ngModel)]="availability.dayOfWeek" name="dayOfWeek">
        <mat-option [value]="0">Sunday</mat-option>
        <mat-option [value]="1">Monday</mat-option>
        <mat-option [value]="2">Tuesday</mat-option>
        <mat-option [value]="3">Wednesday</mat-option>
        <mat-option [value]="4">Thursday</mat-option>
        <mat-option [value]="5">Friday</mat-option>
        <mat-option [value]="6">Saturday</mat-option>
      </mat-select>
    </mat-form-field>
  </form>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button (click)="onNoClick()">Cancel</button>
  <button mat-raised-button color="primary" (click)="onSaveClick()">
    <mat-icon>save</mat-icon>
    Save
  </button>
</mat-dialog-actions>
