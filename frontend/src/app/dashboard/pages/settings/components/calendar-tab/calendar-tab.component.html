<div class="card">
  <div class="card-content">
    <form class="settings-form">
      <mat-form-field appearance="outline">
        <mat-label>Default View</mat-label>
        <mat-select
          [(ngModel)]="prefsHandler.preferences().calendar.defaultView"
          (ngModelChange)="prefsHandler.updateNestedPreference('calendar', 'defaultView', $event)"
          name="defaultView"
          [disabled]="(prefsHandler.loading()) ?? false"
        >
          <mat-option value="day">Day</mat-option>
          <mat-option value="week">Week</mat-option>
          <mat-option value="month">Month</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>First Day of Week</mat-label>
        <mat-select
          [(ngModel)]="prefsHandler.preferences().calendar.firstDayOfWeek"
          (ngModelChange)="prefsHandler.updateNestedPreference('calendar', 'firstDayOfWeek', $event)"
          name="firstDayOfWeek"
          [disabled]="(prefsHandler.loading()) ?? false"
        >
          <mat-option [value]="0">Sunday</mat-option>
          <mat-option [value]="1">Monday</mat-option>
        </mat-select>
      </mat-form-field>

      <div class="working-hours">
        <mat-form-field appearance="outline">
          <mat-label>Working Hours Start</mat-label>
          <input
            matInput
            type="time"
            [(ngModel)]="prefsHandler.preferences().calendar.workingHours.start"
            (ngModelChange)="prefsHandler.updateWorkingHours('start', $event)"
            name="workingHoursStart"
            [disabled]="(prefsHandler.loading()) ?? false"
          />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Working Hours End</mat-label>
          <input
            matInput
            type="time"
            [(ngModel)]="prefsHandler.preferences().calendar.workingHours.end"
            (ngModelChange)="prefsHandler.updateWorkingHours('end', $event)"
            name="workingHoursEnd"
            [disabled]="(prefsHandler.loading()) ?? false"
          />
        </mat-form-field>
      </div>

      <div class="form-actions">
        <button
          mat-flat-button
          color="primary"
          type="button"
          (click)="prefsHandler.saveCalendarSettings()"
          [disabled]="(prefsHandler.loading()) ?? false"
        >
          {{ (prefsHandler.loading()) ? 'Saving...' : 'Save Calendar' }}
        </button>
      </div>
    </form>
  </div>
</div>
