<div class="page-container">
  <div class="page-header">
    <h1 class="page-title">Settings</h1>
    <p class="page-description">Manage your account, appearance, and preferences.</p>
  </div>

  <mat-tab-group class="settings-tabs">
    <mat-tab label="Profile">
      <app-profile-settings 
        (saveProfile)="saveProfile()">
      </app-profile-settings>
    </mat-tab>
    
    <mat-tab label="Notifications">
      <app-notification-settings 
        [preferences]="preferencesHandler.preferences()"
        [loading]="preferencesHandler.loading()"
        (preferenceChange)="handleNestedPreferenceChange($event.key, $event.value)"
        (save)="saveNotificationSettings()">
      </app-notification-settings>
    </mat-tab>
    
    <mat-tab label="Appearance">
      <app-appearance-settings 
        [preferences]="preferencesHandler.preferences()"
        [loading]="preferencesHandler.loading()"
        (preferenceChange)="handleSimplePreferenceChange($event.key, $event.value)"
        (save)="saveAppearanceSettings()">
      </app-appearance-settings>
    </mat-tab>
    
    <mat-tab label="Calendar">
      <app-calendar-settings 
        [preferences]="preferencesHandler.preferences()"
        [loading]="preferencesHandler.loading()"
        (preferenceChange)="handleNestedPreferenceChange($event.key, $event.value)"
        (workingHoursChange)="handleWorkingHoursChange($event.type, $event.value)"
        (save)="saveCalendarSettings()">
      </app-calendar-settings>
    </mat-tab>
    
    <mat-tab label="Privacy">
      <app-privacy-settings 
        [preferences]="preferencesHandler.preferences()"
        [loading]="preferencesHandler.loading()"
        (preferenceChange)="handleNestedPreferenceChange($event.key, $event.value)"
        (save)="savePrivacySettings()">
      </app-privacy-settings>
    </mat-tab>
    
    <mat-tab label="Booking">
      <app-booking-settings 
        [preferences]="preferencesHandler.preferences()"
        [loading]="preferencesHandler.loading()"
        (preferenceChange)="handleNestedPreferenceChange($event.key, $event.value)"
        (hourlyRateChange)="preferencesHandler.updateNestedPreference('payment', 'hourlyRate', $event)"
        (paymentMethodAdded)="addPaymentMethod($event)"
        (paymentMethodRemoved)="removePaymentMethod($event)"
        (save)="saveBookingSettings()">
      </app-booking-settings>
    </mat-tab>
    
    <mat-tab label="Localization">
      <app-localization-settings 
        [preferences]="preferencesHandler.preferences()"
        [loading]="preferencesHandler.loading()"
        (preferenceChange)="handleSimplePreferenceChange($event.key, $event.value)"
        (save)="saveLocalizationSettings()">
      </app-localization-settings>
    </mat-tab>
    
    <mat-tab label="Business">
      <app-business-settings 
        [businessName]="businessService.businessName()"
        [bio]="businessService.bio()"
        [contactPhone]="businessService.contactPhone()"
        [services]="businessService.services()"
        [categories]="businessService.categories()"
        [availableDurations]="businessService.availableDurations()"
        [locationCountry]="businessService.locationCountryModel()"
        [locationCity]="businessService.locationCityModel()"
        [locationAddress]="businessService.locationAddressModel()"
        (businessSettingsChange)="businessService.updateField($event)"
        (save)="saveBusinessSettings()">
      </app-business-settings>
    </mat-tab>
  </mat-tab-group>
</div>