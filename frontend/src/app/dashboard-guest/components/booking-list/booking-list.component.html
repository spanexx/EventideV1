<div class="booking-list-container" role="main">
  <div class="page-header">
    <h1>My Bookings</h1>
    <p>View and manage all your appointments</p>
  </div>
  
  <div class="actions-section">
    <button mat-raised-button color="primary" routerLink="/booking" class="book-now-btn">
      <mat-icon>add</mat-icon>
      Book New Appointment
    </button>
  </div>
  
  <div *ngIf="loading$ | async" class="loading-container" aria-live="polite">
    <mat-spinner aria-label="Loading bookings"></mat-spinner>
    <p>Loading bookings...</p>
  </div>
  
  <div *ngIf="error$ | async as error" class="error-container" aria-live="assertive">
    <p class="error-message">{{ error }}</p>
    <button mat-raised-button color="primary" (click)="ngOnInit()" aria-label="Retry loading bookings">
      Retry
    </button>
  </div>
  
  <div *ngIf="!(loading$ | async) && !(error$ | async)">
    <mat-tab-group>
      <mat-tab label="Upcoming">
        <div class="tab-content">
          <p *ngIf="(upcomingBookings$ | async)?.length === 0">No upcoming bookings</p>
          <mat-card *ngFor="let booking of upcomingBookings$ | async" class="booking-card">
            <mat-card-header>
              <mat-card-title>{{ booking.service }}</mat-card-title>
              <mat-card-subtitle>{{ booking.providerName }}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <p><strong>Date:</strong> {{ booking.date | date }}</p>
              <p><strong>Time:</strong> {{ booking.startTime | date:'shortTime' }} - {{ booking.endTime | date:'shortTime' }}</p>
              <p><strong>Status:</strong> {{ booking.status }}</p>
            </mat-card-content>
            <mat-card-actions>
              <button mat-button color="primary" [routerLink]="['/dashboard-guest/bookings', booking.id]" aria-label="View details for {{ booking.service }} appointment">
                View Details
              </button>
              <button mat-button color="warn" (click)="cancelBooking(booking.id)" aria-label="Cancel {{ booking.service }} appointment">
                Cancel
              </button>
            </mat-card-actions>
          </mat-card>
        </div>
      </mat-tab>
      
      <mat-tab label="Past">
        <div class="tab-content">
          <p *ngIf="(pastBookings$ | async)?.length === 0">No past bookings</p>
          <mat-card *ngFor="let booking of pastBookings$ | async" class="booking-card">
            <mat-card-header>
              <mat-card-title>{{ booking.service }}</mat-card-title>
              <mat-card-subtitle>{{ booking.providerName }}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
              <p><strong>Date:</strong> {{ booking.date | date }}</p>
              <p><strong>Time:</strong> {{ booking.startTime | date:'shortTime' }} - {{ booking.endTime | date:'shortTime' }}</p>
              <p><strong>Status:</strong> {{ booking.status }}</p>
            </mat-card-content>
            <mat-card-actions>
              <button mat-button color="primary" [routerLink]="['/dashboard-guest/bookings', booking.id]" aria-label="View details for {{ booking.service }} appointment">
                View Details
              </button>
            </mat-card-actions>
          </mat-card>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>
</div>